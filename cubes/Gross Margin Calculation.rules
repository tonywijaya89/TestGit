#Region System
FEEDSTRINGS;
SKIPCHECK;
#EndRegion

#Region Link rule: Gross Mrgin Calc<Base Sales Forecast - Numeric
#Source cube: Base Sales Forecast
#Target cube: Gross Margin Calculation
#Autogenerated LINK NUMERIC 7D4C696E6B5F47726F7373204D7267696E2043616C635F3343426173652053616C657320466F726563617374
#@AutoGenerated
['Gross Sales Margin':{'Volume Discount','Freight','Cash Discount','Existing Stores Revenue','GROSS MARGIN %','Returns and Allowances'}] = N:DB('Base Sales Forecast', 
    !Country and Region, !Retailers, ATTRS('Gross Sales Margin', 
    !Gross Sales Margin, '}Map_}Link_Gross Mrgin Calc_3CBase Sales Forecast'), 
    !Store Type, !Budget version, !Month);
#EndRegion

#Region Link rule: Gross Margin Calc<Single Promotions - Numeric
#Source cube: Promotions Plan
#Target cube: Gross Margin Calculation
#Autogenerated LINK NUMERIC 7D4C696E6B5F47726F7373204D617267696E2043616C635F334353696E676C652050726F6D6F74696F6E73
#@AutoGenerated
['Gross Sales Margin':'Effect of  Single Retailer Promotions'] = N:(DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '1', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '2', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '3', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '4', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '5', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '6', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '7', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '8', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '9', 
    !Budget version, 'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', 
    !Retailers, !Store Type, !Month, !Country and Region, '10', 
    !Budget version, 'Sales Increase %'));
#EndRegion

#Region Link rule: Gross Margin Calc<New Stores Plan - Numeric
#Source cube: New Store Plan
#Target cube: Gross Margin Calculation
#Autogenerated LINK NUMERIC 7D4C696E6B5F47726F7373204D617267696E2043616C635F33434E65772053746F72657320506C616E
#@AutoGenerated
['Gross Sales Margin':'New Store Opening (hide)'] = N:(DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '1', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '2', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '3', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '4', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '5', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '6', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '7', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '8', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '9', 
    !Budget version, 'Sum of Average Monthly Revenue') + DB('}ICube_}Link_Gross Margin Calc_3CNew Stores Plan', 
    !Retailers, !Store Type, !Month, !Country and Region, '10', 
    !Budget version, 'Sum of Average Monthly Revenue'));
#EndRegion

#Region Link rule: Gross Margin Calc<Promotions Plan - Numeric
#Source cube: Promotions Plan
#Target cube: Gross Margin Calculation
#Autogenerated LINK NUMERIC 7D4C696E6B5F47726F7373204D617267696E2043616C635F334350726F6D6F74696F6E7320506C616E
#@AutoGenerated
['Retailers':{'Warehouse Store','Golf Shop','Outdoors Shop','Direct Marketing','Department Store','Eyewear Store','Sports Store','Equipment Rental Store'}, 'Gross Sales Margin':'Effect of All Store Promotions'] = N:(DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '1', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '2', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '3', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '4', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '5', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '6', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '7', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '8', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '9', !Budget version, 
    'Sales Increase %') + DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', 
    'All', !Store Type, !Month, !Country and Region, '10', !Budget version, 
    'Sales Increase %'));
#EndRegion

#Region N-Calculation rules: Dimension:Gross Sales Margin
#Autogenerated CALC NUMERIC 47726F73732053616C6573204D617267696E
   #Region Dimension:Gross Sales Margin, Member:New Stores revenue
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B4E65772053746F72657320726576656E75655D
   #@AutoGenerated
   ['Gross Sales Margin':{'New Stores revenue'}]=N:DB('Gross Margin Calculation', !Retailers, !Country and Region, !Store Type, !Month, !Budget version, 'New Store Opening (hide)')+DB('Gross Margin Calculation', !Retailers, !Country and Region, !Store Type, ATTRS('Month', !Month, 'previousperiod'), !Budget version, !Gross Sales Margin);
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:GROSS REVENUE
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B47524F535320524556454E55455D
   #@AutoGenerated
   ['Gross Sales Margin':{'GROSS REVENUE'}]=N:['Gross Sales Margin':'Existing Stores Revenue']+['Gross Sales Margin':'New Stores revenue'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:ADJUSTED GROSS REVENUE
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B41444A55535445442047524F535320524556454E55455D
   #@AutoGenerated
   ['Gross Sales Margin':{'ADJUSTED GROSS REVENUE'}]=N:['Gross Sales Margin':'GROSS REVENUE']*(1+(['Gross Sales Margin':'Population Growth']+['Gross Sales Margin':'Economic Growth']+['Gross Sales Margin':'Effect of  Single Retailer Promotions']+['Gross Sales Margin':'Effect of All Store Promotions'])\100);
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:GROSS MARGIN BEFORE COSTS
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B47524F5353204D415247494E204245464F524520434F5354535D
   #@AutoGenerated
   ['Gross Sales Margin':{'GROSS MARGIN BEFORE COSTS'}]=N:(['Gross Sales Margin':'ADJUSTED GROSS REVENUE']*['Gross Sales Margin':'GROSS MARGIN %'])\100;
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:TOTAL DISCOUNTS AND ALLOWANCES
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B544F54414C20444953434F554E545320414E4420414C4C4F57414E4345535D
   #@AutoGenerated
   ['Gross Sales Margin':{'TOTAL DISCOUNTS AND ALLOWANCES'}]=N:['Gross Sales Margin':'Returns and Allowances']+['Gross Sales Margin':'Volume Discount']+['Gross Sales Margin':'Cash Discount'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:GROSS MARGIN
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B47524F5353204D415247494E5D
   #@AutoGenerated
   ['Gross Sales Margin':{'GROSS MARGIN'}]=N:['Gross Sales Margin':'GROSS MARGIN BEFORE COSTS']-['Gross Sales Margin':'TOTAL DISCOUNTS AND ALLOWANCES']-['Gross Sales Margin':'Freight'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:PGWA
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B504757415D
   #@AutoGenerated
   ['Gross Sales Margin':{'PGWA'}]=N:(['Gross Sales Margin':'Population Growth']*['Gross Sales Margin':'GROSS REVENUE'])\100;
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:EGWA
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B454757415D
   #@AutoGenerated
   ['Gross Sales Margin':{'EGWA'}]=N:(['Gross Sales Margin':'Economic Growth']\100)*['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:SRWA
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B535257415D
   #@AutoGenerated
   ['Gross Sales Margin':{'SRWA'}]=N:(['Gross Sales Margin':'Effect of  Single Retailer Promotions']\100)*['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:ASPWA
   #Autogenerated MEMBERCALC NUMERIC 5B47726F73732053616C6573204D617267696E5D2E5B41535057415D
   #@AutoGenerated
   ['Gross Sales Margin':{'ASPWA'}]=N:(['Gross Sales Margin':'Effect of All Store Promotions']\100)*['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
#EndRegion

#Region N-Calculation rules: Dimension:Retailers
#Autogenerated CALC NUMERIC 52657461696C657273
   #Region Dimension:Retailers, Member:All
   #Autogenerated MEMBERCALC NUMERIC 5B52657461696C6572735D2E5B416C6C5D
   #@AutoGenerated
   ['Retailers':{'All'}]=N:['Retailers':'Department Store']+['Retailers':'Direct Marketing']+['Retailers':'Equipment Rental Store']+['Retailers':'Eyewear Store']+['Retailers':'Golf Shop']+['Retailers':'Outdoors Shop']+['Retailers':'Sports Store']+['Retailers':'Warehouse Store'];
   #EndRegion
#EndRegion

#Region C-Calculation rules: Dimension:Gross Sales Margin
#Autogenerated CALC CONSOLIDATED 47726F73732053616C6573204D617267696E
   #Region Dimension:Gross Sales Margin, Member:Population Growth
   #Autogenerated MEMBERCALC CONSOLIDATED 5B47726F73732053616C6573204D617267696E5D2E5B506F70756C6174696F6E2047726F7774685D
   #@AutoGenerated
   ['Gross Sales Margin':{'Population Growth'}]=C:(['Gross Sales Margin':'PGWA']*100)\['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:Economic Growth
   #Autogenerated MEMBERCALC CONSOLIDATED 5B47726F73732053616C6573204D617267696E5D2E5B45636F6E6F6D69632047726F7774685D
   #@AutoGenerated
   ['Gross Sales Margin':{'Economic Growth'}]=C:(['Gross Sales Margin':'EGWA']*100)\['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:Effect of  Single Retailer Promotions
   #Autogenerated MEMBERCALC CONSOLIDATED 5B47726F73732053616C6573204D617267696E5D2E5B456666656374206F66202053696E676C652052657461696C65722050726F6D6F74696F6E735D
   #@AutoGenerated
   ['Gross Sales Margin':{'Effect of  Single Retailer Promotions'}]=C:(['Gross Sales Margin':'SRWA']*100)\['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:Effect of All Store Promotions
   #Autogenerated MEMBERCALC CONSOLIDATED 5B47726F73732053616C6573204D617267696E5D2E5B456666656374206F6620416C6C2053746F72652050726F6D6F74696F6E735D
   #@AutoGenerated
   ['Gross Sales Margin':{'Effect of All Store Promotions'}]=C:(['Gross Sales Margin':'ASPWA']*100)\['Gross Sales Margin':'GROSS REVENUE'];
   #EndRegion
   #Region Dimension:Gross Sales Margin, Member:GROSS MARGIN %
   #Autogenerated MEMBERCALC CONSOLIDATED 5B47726F73732053616C6573204D617267696E5D2E5B47524F5353204D415247494E20255D
   #@AutoGenerated
   ['Gross Sales Margin':{'GROSS MARGIN %'}]=C:(['Gross Sales Margin':'GROSS MARGIN BEFORE COSTS']*100)\['Gross Sales Margin':'ADJUSTED GROSS REVENUE'];
   #EndRegion
#EndRegion

FEEDERS;
#Region Automatically generated feeders
#Autogenerated AUTOFEEDERS
['Gross Sales Margin':'GROSS REVENUE'] => ['Gross Sales Margin':'EGWA'];
['Retailers':{'Eyewear Store', 'Outdoors Shop', 'Sports Store', 'Direct Marketing', 'Department Store', 'Golf Shop', 'Warehouse Store', 'Equipment Rental Store'}, 'Gross Sales Margin':{'Effect of All Store Promotions', 'Economic Growth', 'Population Growth'}] => ['Retailers':'All'];
['Gross Sales Margin':{'TOTAL DISCOUNTS AND ALLOWANCES', 'Freight', 'GROSS MARGIN BEFORE COSTS'}] => ['Gross Sales Margin':'GROSS MARGIN'];
['Gross Sales Margin':{'Cash Discount', 'Volume Discount', 'Returns and Allowances'}] => ['Gross Sales Margin':'TOTAL DISCOUNTS AND ALLOWANCES'];
['Gross Sales Margin':{'Existing Stores Revenue', 'New Stores revenue'}] => ['Gross Sales Margin':'GROSS REVENUE'];
['Gross Sales Margin':'GROSS MARGIN %'] => ['Gross Sales Margin':'GROSS MARGIN BEFORE COSTS'];
['Gross Sales Margin':'GROSS REVENUE'] => ['Gross Sales Margin':'ADJUSTED GROSS REVENUE'];
['Gross Sales Margin':'GROSS REVENUE'] => ['Gross Sales Margin':'SRWA'];
['Gross Sales Margin':'GROSS REVENUE'] => ['Gross Sales Margin':'PGWA'];
['Gross Sales Margin':'GROSS REVENUE'] => ['Gross Sales Margin':'ASPWA'];
['Gross Sales Margin':'New Stores revenue'] => DB('Gross Margin Calculation', !Retailers, !Country and Region, 
    !Store Type, ATTRS('Month', !Month, 'nextperiod'), !Budget version, 
    !Gross Sales Margin);
['Gross Sales Margin':'New Store Opening (hide)'] => ['Gross Sales Margin':'New Stores revenue'];
#EndRegion