#Region System
FEEDSTRINGS;
SKIPCHECK;
#EndRegion
['Min % Planned Promotion Value']=N:(IF( !Country and Region @='Asia Pacific', 1.05,0.898));

#Region Link rule: Promotions Plan<Base Sales Forecast - Numeric
#Source cube: Base Sales Forecast
#Target cube: Promotions Plan
#Autogenerated LINK NUMERIC 7D4C696E6B5F50726F6D6F74696F6E7320506C616E5F3343426173652053616C657320466F726563617374
#@AutoGenerated
['Promotions':'Base Monthly Sales'] = N:DB('Base Sales Forecast', 
    !Country and Region, DB('Promotions Plan', !Country and Region, 
    !ID numbers, !Budget version, 'Retailer Type'), 'Existing Stores Revenue', 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 
    'Franchise/Corporate'), !Budget version, DB('Promotions Plan', 
    !Country and Region, !ID numbers, !Budget version, 'Month of Promotion'));
#EndRegion

#Region N-Calculation rules: Dimension:Promotions
#Autogenerated CALC NUMERIC 50726F6D6F74696F6E73
   #Region Dimension:Promotions, Member:Planned Promotion Value
   #Autogenerated MEMBERCALC NUMERIC 5B50726F6D6F74696F6E735D2E5B506C616E6E65642050726F6D6F74696F6E2056616C75655D
   #@AutoGenerated
   ['Promotions':{'Planned Promotion Value'}]=N:(['Promotions':'Sales Increase %']\100)*['Promotions':'Base Monthly Sales']-(['Promotions':'Advertising Costs']+['Promotions':'Promotion Costs']);
   #EndRegion
   #Region Dimension:Promotions, Member:% Planned Promotion Value
   #Autogenerated MEMBERCALC NUMERIC 5B50726F6D6F74696F6E735D2E5B2520506C616E6E65642050726F6D6F74696F6E2056616C75655D
   #@AutoGenerated
   ['Promotions':{'% Planned Promotion Value'}]=N:(['Promotions':'Planned Promotion Value']*100)\['Promotions':'Base Monthly Sales']-['Promotions':'Min % Planned Promotion Value'];
   #EndRegion
   #Region Dimension:Promotions, Member:Test flag
   #Autogenerated MEMBERCALC NUMERIC 5B50726F6D6F74696F6E735D2E5B5465737420666C61675D
   #@AutoGenerated
   ['Promotions':{'Test flag'}]=N:IF(['Promotions':'% Planned Promotion Value']<0,1,0);
   #EndRegion
   #Region Dimension:Promotions, Member:SIWA
   #Autogenerated MEMBERCALC NUMERIC 5B50726F6D6F74696F6E735D2E5B534957415D
   #@AutoGenerated
   ['Promotions':{'SIWA'}]=N:(['Promotions':'Sales Increase %']\100)*['Promotions':'Base Monthly Sales'];
   #EndRegion
#EndRegion

#Region C-Calculation rules: Dimension:Promotions
#Autogenerated CALC CONSOLIDATED 50726F6D6F74696F6E73
   #Region Dimension:Promotions, Member:Sales Increase %
   #Autogenerated MEMBERCALC CONSOLIDATED 5B50726F6D6F74696F6E735D2E5B53616C657320496E63726561736520255D
   #@AutoGenerated
   ['Promotions':{'Sales Increase %'}]=C:(['Promotions':'SIWA']*100)\['Promotions':'Base Monthly Sales'];
   #EndRegion
   #Region Dimension:Promotions, Member:% Planned Promotion Value
   #Autogenerated MEMBERCALC CONSOLIDATED 5B50726F6D6F74696F6E735D2E5B2520506C616E6E65642050726F6D6F74696F6E2056616C75655D
   #@AutoGenerated
   ['Promotions':{'% Planned Promotion Value'}]=C:(['Promotions':'Planned Promotion Value']*100)\['Promotions':'Base Monthly Sales'];
   #EndRegion
#EndRegion

FEEDERS;
#Region Automatically generated feeders
#Autogenerated AUTOFEEDERS
['Promotions':{'Month of Promotion', 'Retailer Type'}] => DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Retailer Type'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Franchise/Corporate'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Month of Promotion'), 
    !Country and Region, !ID numbers, !Budget version, 'Sales Increase %');
['Promotions':'Base Monthly Sales'] => ['Promotions':'SIWA'];
['Promotions':{'Min % Planned Promotion Value', 'Base Monthly Sales'}] => ['Promotions':'% Planned Promotion Value'];
['Promotions':'% Planned Promotion Value'] => ['Promotions':'Test flag'];
['Promotions':{'Franchise/Corporate', 'Retailer Type'}] => DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Retailer Type'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Franchise/Corporate'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Month of Promotion'), 
    !Country and Region, !ID numbers, !Budget version, 'Sales Increase %');
['Promotions':'Month of Promotion'] => DB('}ICube_}Link_Gross Margin Calc_3CSingle Promotions', DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Retailer Type'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Franchise/Corporate'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Month of Promotion'), 
    !Country and Region, !ID numbers, !Budget version, 'Sales Increase %');
['Promotions':'Franchise/Corporate'] => DB('}ICube_}Link_Gross Margin Calc_3CPromotions Plan', DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Retailer Type'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Franchise/Corporate'), 
    DB('Promotions Plan', !Country and Region, !ID numbers, !Budget version, 'Month of Promotion'), 
    !Country and Region, !ID numbers, !Budget version, 'Sales Increase %');
['Promotions':{'Promotion Costs', 'Advertising Costs', 'Base Monthly Sales'}] => ['Promotions':'Planned Promotion Value'];
['Promotions':'Retailer Type'] => ['Promotions':'Base Monthly Sales'];
#EndRegion